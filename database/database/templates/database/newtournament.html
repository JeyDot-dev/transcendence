
<!DOCTYPE html>
<html lang="en">
<body>
    <div class="container">
        <h1>New Tournament</h1>
        <form method="post">
            {% csrf_token %}
            {{ form.as_p }}
        </form>
        <div class="form-group">
            <label for="num-players">Number of Players:</label>
            <input type="number" id="num-players" class="form-control" min="1" value="1">
            <button type="button" class="btn btn-secondary mt-2" onclick="generatePlayerForms()">Continue</button>
        </div>
        <form method="post" style="display:none;" id="player-form-container">
            {% csrf_token %}
            <div id="player-formset">
                {{ formset.management_form }}
            </div>
            <input type="submit" class="btn btn-primary" value="Save">
        </form>
    </div>

    <script>
        function generatePlayerForms() {
            var formCount = document.querySelectorAll('#player-formset .form-group').length;
            var numForms = parseInt(document.getElementById('num-players').value);
            var playerFormset = document.getElementById('player-formset');
             
            // Clear existing forms
            playerFormset.innerHTML = '';

            // Append the management form
            var managementForm = document.createElement('div');
            managementForm.innerHTML = '{{ formset.management_form|safe }}';
            playerFormset.appendChild(managementForm.firstChild);

            // Add the specified number of forms
            for (var i = 0; i < numForms; i++) {
                var newForm = document.createElement('div');
                newForm.className = 'form-group';
                var emptyFormHtml = `{{ formset.empty_form.as_p|escapejs }}`;
                newForm.innerHTML = emptyFormHtml.replace(/__prefix__/g, i);
                playerFormset.appendChild(newForm);
            }

            // Update the TOTAL_FORMS count
            document.querySelector('#id_form-TOTAL_FORMS').value = numForms;

            // Show the form container
            document.getElementById('player-form-container').style.display = 'block';
        }
    </script>
</body>
</html>

        